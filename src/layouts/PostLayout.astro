---
import BaseLayout from './BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import GithubSlugger from 'github-slugger';
import siteMetadata from '../../data/siteMetadata.js';

interface Props {
  title: string;
  date: string;
  summary?: string;
  tags?: string[];
  slug: string;
}

const { title, date, summary, tags, slug } = Astro.props;
const slugger = new GithubSlugger();

const postDateTemplate: Intl.DateTimeFormatOptions = {
  weekday: 'long',
  year: 'numeric',
  month: 'long',
  day: 'numeric',
};
---

<BaseLayout title={title} description={summary}>
  <Header slot="header" />

  <article>
    <div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700">
      <header class="pt-6 xl:pb-6">
        <div class="space-y-1 text-center">
          <dl class="space-y-10">
            <div>
              <dt class="sr-only">Published on</dt>
              <dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400">
                <time datetime={date}>
                  {new Date(date).toLocaleDateString(siteMetadata.locale, postDateTemplate)}
                </time>
              </dd>
            </div>
          </dl>
          <div>
            <h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">
              {title}
            </h1>
          </div>
        </div>
      </header>
      <div class="grid-rows-[auto_1fr] divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0">
        <dl class="pb-10 pt-6 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700">
          <dt class="sr-only">Authors</dt>
          <dd>
            <div class="text-sm font-medium leading-5 text-gray-500 dark:text-gray-400">
              {siteMetadata.author}
            </div>
          </dd>
        </dl>
        <div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0">
          <div class="prose max-w-none pb-8 pt-10 dark:prose-invert">
            <slot />
          </div>
        </div>
        <footer>
          <div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y">
            {tags && tags.length > 0 && (
              <div class="py-4 xl:py-8">
                <h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">
                  Tags
                </h2>
                <div class="flex flex-wrap">
                  {tags.map((tag) => (
                    <a
                      href={`/tags/${slugger.slug(tag)}`}
                      class="mr-3 text-sm font-medium uppercase text-primary-700 hover:text-primary-600 dark:hover:text-primary-400"
                    >
                      {tag.split(' ').join('-')}
                    </a>
                  ))}
                </div>
              </div>
            )}
          </div>
          <div class="pt-4 xl:pt-8">
            <a
              href="/blog"
              class="text-primary-800 hover:text-primary-600 dark:hover:text-primary-400"
              aria-label="Back to the blog"
            >
              &larr; Back to the blog
            </a>
          </div>
        </footer>
      </div>
    </div>
  </article>

  <Footer slot="footer" />
</BaseLayout>
